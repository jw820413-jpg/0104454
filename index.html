<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>ì¼ì¼ì¬ê³ í˜„í™©í‘œ_ìµœì¢…ì§„í™”í˜•</title>
    <style>
        :root { --line-color: #333; --blue-text: #0056b3; --orange-text: #cc6600; --green-bar: #99ff99; }
        body { font-family: 'Malgun Gothic', sans-serif; background: #f4f4f4; padding: 20px; display: flex; flex-direction: column; align-items: center; }
        
        /* [ì¸ì‡„ ì„¤ì •] ì¸ì‡„í•  ë•Œ ì…ë ¥ì°½ ë“± ë¶ˆí•„ìš”í•œ ë¶€ë¶„ ìˆ¨ê¹€ */
        @media print {
            .no-print { display: none !important; }
            body { background: white; padding: 0; }
            .paper { box-shadow: none; border: none; width: 100%; }
        }

        .paper { width: 1300px; background: white; padding: 40px; border: 1px solid #999; box-shadow: 0 0 10px rgba(0,0,0,0.1); position: relative; }
        .header { text-align: center; margin-bottom: 50px; }
        .header h1 { font-size: 38px; text-decoration: underline; letter-spacing: 20px; font-weight: 500; display: inline-block; }
        
        .date-container { position: absolute; top: 100px; right: 40px; font-weight: bold; }
        #stockDate { border: 1px solid #ddd; padding: 5px; font-family: inherit; font-size: 16px; font-weight: bold; border-radius: 4px; }

        .silo-section { margin-bottom: 60px; }
        .section-title { text-align: center; font-weight: bold; font-size: 20px; margin-bottom: 20px; }

        .grid-container { display: grid; grid-template-columns: repeat(12, 1fr); gap: 2px; }
        .column { display: flex; flex-direction: column; align-items: center; position: relative; }
        .column::before { content: ""; position: absolute; top: 20px; bottom: 20px; width: 1.5px; background: var(--line-color); z-index: 1; }

        .node { background: white; border: 1.5px solid var(--line-color); z-index: 2; display: flex; flex-direction: column; justify-content: center; align-items: center; text-align: center; line-height: 1.2; position: relative; }
        .circle { width: 92px; height: 92px; border-radius: 50%; border-color: var(--blue-text); margin: -5px 0; }
        .circle .item { color: var(--blue-text); font-weight: bold; font-size: 13px; }
        .circle .qty { font-size: 16px; font-weight: 900; }
        .circle .loc { color: #88ac88; font-size: 11px; font-weight: bold; }

        .rect { width: 85px; height: 52px; border-color: #666; margin: 10px 0; }
        .rect .item { color: var(--orange-text); font-weight: bold; font-size: 11px; }
        .rect .qty { font-size: 14px; font-weight: bold; }
        .rect .loc { color: #88ac88; font-size: 10px; font-weight: bold; }

        .zero { background-color: #ffeef2 !important; border-color: red !important; border-width: 2px !important; }
        .zero * { color: red !important; }
        .has-green-bar { border-bottom: 10px solid var(--green-bar) !important; }

        /* ì œì–´ êµ¬ì—­ */
        .controls { width: 1300px; margin-top: 30px; padding: 20px; background: #fff; border: 2px solid #0056b3; border-radius: 8px; box-sizing: border-box; }
        #dataInput { width: 100%; height: 100px; margin-top: 10px; padding: 10px; border: 1px solid #ccc; border-radius: 4px; font-family: monospace; box-sizing: border-box; }
        .btn-print { margin-top: 15px; padding: 10px 25px; background: #28a745; color: white; border: none; border-radius: 5px; cursor: pointer; font-weight: bold; font-size: 16px; }
        .btn-print:hover { background: #218838; }
    </style>
</head>
<body>

<div class="paper">
    <div class="date-container">
        ë‚ ì§œ: <input type="date" id="stockDate">
    </div>
    <div class="header"><h1>ì¼ ì¼ ì¬ ê³  í˜„ í™© í‘œ</h1></div>
    <div id="content"></div>
</div>

<div class="controls no-print">
    <strong>ğŸ“‹ ë°ì´í„° ë¶™ì—¬ë„£ê¸°</strong>
    <textarea id="dataInput" placeholder="ì—‘ì…€ì˜ [ì¥ì¹˜ì¥, ê³¡ì¢…, ì¬ê³ ëŸ‰] ì˜ì—­ì„ ë³µì‚¬í•´ì„œ ì—¬ê¸°ì— ë¶™ì—¬ë„£ìœ¼ì„¸ìš”."></textarea>
    <button class="btn-print" onclick="window.print()">ğŸ–¨ï¸ í˜„í™©í‘œ ì¸ì‡„í•˜ê¸°</button>
    <p style="font-size: 12px; color: #666;">â€» ë³´ì•ˆ í”„ë¡œê·¸ë¨ ê±±ì • ì—†ì´ í…ìŠ¤íŠ¸ë§Œ ë³µì‚¬í•´ì„œ ë¶™ì—¬ë„£ìœ¼ì‹œë©´ ë©ë‹ˆë‹¤.</p>
</div>

<script>
    const input = document.getElementById('dataInput');
    const stockDateInput = document.getElementById('stockDate');
    const content = document.getElementById('content');

    // ì˜¤ëŠ˜ ë‚ ì§œ ìë™ ì„¤ì •
    window.onload = () => {
        const today = new Date().toISOString().split('T')[0];
        stockDateInput.value = today;
        updateDashboard(""); 
    };

    // ë¶™ì—¬ë„£ê¸° í•  ë•Œë§ˆë‹¤ ì¦‰ì‹œ ì—…ë°ì´íŠ¸
    input.addEventListener('input', () => {
        updateDashboard(input.value);
    });

    function updateDashboard(dataText) {
        const rawData = dataText.split('\n').filter(line => line.trim() !== "");
        const dataMap = {};

        rawData.forEach(line => {
            const parts = line.split(/\s+/);
            if (parts.length >= 3) {
                const loc = parts[0];
                const item = parts[1];
                const cleanQty = parts[2].replace(/,/g, '');
                const qtyFormatted = isNaN(parseFloat(cleanQty)) ? parts[2] : parseFloat(cleanQty).toLocaleString();
                dataMap[loc] = { item, qty: qtyFormatted, isZero: parseFloat(cleanQty) === 0 };
            }
        });

        let html = '';
        ['A', 'B'].forEach(section => {
            html += `<div class="silo-section"><div class="section-title">ì‹¸ì´ë¡œ ${section}</div><div class="grid-container">`;
            for (let col = 1; col <= 12; col++) {
                html += `<div class="column">`;
                for (let row = 1; row <= 5; row++) {
                    const locId = `${section}${row}${col < 10 ? '0' + col : col}`;
                    const d = dataMap[locId] || { item: '-', qty: '-', isZero: false };
                    
                    const isCircle = (row % 2 !== 0);
                    const nodeClass = isCircle ? 'circle' : 'rect';
                    const zeroClass = d.isZero ? 'zero' : '';
                    const greenBarClass = ['A208', 'A407', 'B407'].includes(locId) ? 'has-green-bar' : '';

                    html += `
                        <div class="node ${nodeClass} ${zeroClass} ${greenBarClass}">
                            <div class="item">${d.item}</div>
                            <div class="qty">${d.qty}</div>
                            <div class="loc">${locId}</div>
                        </div>`;
                }
                html += `</div>`;
            }
            html += `</div></div>`;
        });
        content.innerHTML = html;
    }
</script>

</body>
</html>
